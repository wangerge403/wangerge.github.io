<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport"
        content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>购物车</title>
    <link rel="stylesheet" href="css/aui.css">
    <link rel="stylesheet" href="css/aui-slide.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/shopping.css">
</head>

<body style="background:#fff">
    <div class="aui-content">
        <div class="shopping">
            <header class="aui-bar aui-bar-nav" style="position:relative">
                <a href="javascript:history.back(-1)" class="aui-pull-left aui-btn header-left-class">
                    <img class="index-gd" src="img/ico_10.png" alt="">
                </a>
                <div class="aui-title   aui-font-size-18" style="font-weight: normal;">购物车</div>
                <a class="aui-pull-right aui-btn header-class">

                </a>
            </header>
            <ul class="shopping-list">
                <li class="aui-col-xs-4 cue">1.购物车列表</li>
                <li class="aui-col-xs-4">2.确认订单</li>
                <li class="aui-col-xs-4">3.购买成功</li>
            </ul>
            <section class="shopping-empty">
                <div class="empty-back"></div>
                <p>没有宝贝哦，不如去添加宝贝</p>
                <div class="empty-a">
                    <a href="" style="background:#6bd0a2"> 去购物 </a>
                    <a href="" style="background:#0082DF"> 查看收藏夹</a>
                </div>
            </section>
            <section class="shopping-number">
                <ul class="number-list aui-padded-10">
                    <li>
                        <div class="number-left aui-col-xs-4 aui-padded-5">
                            <img src="img/797_thumb_G_1512735997900.jpg" alt="">
                        </div>
                        <div class="number-left aui-col-xs-8 aui-padded-5">
                            <p class="number-left-text">ectouch微信拼团手机模板</p>
                            <div class="number-money">
                                <div class="aui-col-xs-5 money-left">
                                    ￥<em class="moneys">150.00</em>
                                </div>
                                <div class="number-sl aui-col-xs-7">
                                    <div class="number-r">
                                        <button type="button" class="decrease">-</button>
                                        <input class="num" type="text" name="winning_rate[]" min="1" max="1000"
                                            value="1" size="4">
                                        <button type="button" class="increase">+</button>

                                    </div>
                                    <div class="number-x aui-iconfont aui-icon-close"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="number-left aui-col-xs-4 aui-padded-5">
                            <img src="img/797_thumb_G_1512735997900.jpg" alt="">
                        </div>
                        <div class="number-left aui-col-xs-8 aui-padded-5">
                            <p class="number-left-text">ectouch微信拼团手机模板</p>
                            <div class="number-money">
                                <div class="aui-col-xs-5 money-left">
                                    ￥<em class="moneys">150.00</em>
                                </div>
                                <div class="number-sl aui-col-xs-7">
                                    <div class="number-r">
                                        <button type="button" class="decrease">-</button>
                                        <input class="num" type="text" name="winning_rate[]" min="1" max="1000"
                                            value="1" size="4">
                                        <button type="button" class="increase">+</button>

                                    </div>
                                    <div class="number-x aui-iconfont aui-icon-close"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="number-left aui-col-xs-4 aui-padded-5">
                            <img src="img/797_thumb_G_1512735997900.jpg" alt="">
                        </div>
                        <div class="number-left aui-col-xs-8 aui-padded-5">
                            <p class="number-left-text">ectouch微信拼团手机模板</p>
                            <div class="number-money">
                                <div class="aui-col-xs-5 money-left">
                                    ￥<em class="moneys">150.00</em>
                                </div>
                                <div class="number-sl aui-col-xs-7">
                                    <div class="number-r">
                                        <button type="button" class="decrease">-</button>
                                        <input class="num" type="text" name="winning_rate[]" min="1" max="1000"
                                            value="1" size="4">
                                        <button type="button" class="increase">+</button>

                                    </div>
                                    <div class="number-x aui-iconfont aui-icon-close"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="number-left aui-col-xs-4 aui-padded-5">
                            <img src="img/797_thumb_G_1512735997900.jpg" alt="">
                        </div>
                        <div class="number-left aui-col-xs-8 aui-padded-5">
                            <p class="number-left-text">ectouch微信拼团手机模板</p>
                            <div class="number-money">
                                <div class="aui-col-xs-5 money-left">
                                    ￥<em class="moneys">154.00</em>
                                </div>
                                <div class="number-sl aui-col-xs-7">
                                    <div class="number-r">
                                        <button type="button" class="decrease">-</button>
                                        <input class="num" type="text" name="winning_rate[]" min="1" max="1000"
                                            value="1" size="4">
                                        <button type="button" class="increase">+</button>

                                    </div>
                                    <div class="number-x aui-iconfont aui-icon-close"></div>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </section>
            <div class="number-foot">
                <div class="number-foot-l aui-col-xs-8 aui-padded-l-10 aui-padded-r-10">
                    合计：<span>￥<em id="total">600</em></span>
                </div>
                <a href="confirm.html" class="number-foot-r aui-col-xs-4">
                    结算(<span id="number">4</span>)
                </a>
            </div>
        </div>
    </div>

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/api.js"></script>
    <script src="js/aui-dialog.js"></script>
    <script>
        var dialog = new auiDialog({});
        var img_url = 0;
        $("input[name='winning_rate[]']").each(function () {
            img_url += parseInt($(this).val());
        });
        $("#number").html(img_url);

        var money = 0;
        $(".moneys").each(function () {
            money += parseInt($(this).html());
        });

        $("#total").html(money);
        var plus = 1;
        var and = 0;
        $(".increase").click(function () {

            var plus = $(this).prev().val();
            var sam = parseInt(plus) + 1;
            console.log('我是单个商品数量' + sam);
            if (sam == 0) {
                return;
            }
            $(this).prev().val(sam);
            var total = $("#total").html();
            var moneys = $(this).parent().parent().prev().children(".moneys").html();
            $("#total").html(Number(total) + Number(moneys));
            var ber = Number($("#number").html()) + 1;

            $("#number").html(ber);
            //    console.log('我是总商品数量' +ber)
            console.log($("#number").html());
        });
        $(".decrease").click(function () {
            var plus = $(this).next().val();
            if (plus > 1) {
                var sam = parseInt(plus) - 1;
                console.log(sam);
                if (sam == 0) {
                    return;
                }
                $(this).next().val(sam);
                var moneys = $(this).parent().parent().prev().children(".moneys").html();
                var total = $("#total").html();
                $("#total").html(Number(total) - Number(moneys));
                var ber = Number($("#number").html()) - 1;

            $("#number").html(ber);
            }

        });


        $(".number-x").click(function () {
            var nub = $(this).prev().children(".num").val();
            var nm = $(this).parent().prev().children(".moneys").html();
            var tl = $("#total").html();
            var nb = $("#number").html();

            var that = this;
            dialog.alert({
                msg: '<a style="color: #101010;">您确实要把该商品移出购物车吗？</a>',
                buttons: ['<a style="color:#666;">取消</a>', '<a style="color: #f75252;">确定</a>']
            }, function (ret) {
                if (ret.buttonIndex == 2) {
                    $("#total").html(Number(tl) - Number(nm) * nub);
                    $("#number").html(Number(nb) - nub);
                    $(that).parent().parent().parent().parent().remove();
                    
                }
            });
        })
    </script>
</body>

</html>